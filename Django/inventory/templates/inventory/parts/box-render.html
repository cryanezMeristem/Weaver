{% load general_extras %}
<div class="glycerolstock_box col-4">
    <div class="glycerolstock_box-inner">
        <div class="glycerolstock_box-title">
            <a href="{% url 'glycerolstock_box' box_id=box.id %}" class="btn btn-primary" role="button">
                {{box.name}}
            </a>
        </div>
        <table class="glycerolstock_box-detail">
            <tr>
                <th></th>
                {% for box_column in collection.BOX_COLUMNS %}
                <th>{{box_column.1}}</th>
                {% endfor %}
            </tr>
            {% for box_row in collection.BOX_ROWS %}
            <tr>
                <th>{{box_row.1}}</th>
                {% for box_column in collection.BOX_COLUMNS %}

                {% with box_row.1|add:box_column.1 as current_pos %}
                {% if current_pos in box %}
                    {% for g_element in box|get_element_by_key:current_pos%}
                        <td class="box-position box-position-used" data-bs-toggle="tooltip" data-bs-placement="top"
                            title="{% if render_mod == 'n'  %}{{g_element}}{% else %}Not available{% endif %}"
                        >
                            {% if render_mod == "n"  %}
                            <a href="{% url 'glycerolstock' glycerolstock_id=g_element.id %}" class="text-dark">{{box_row.1}}{{box_column.1}}</a>
                            {% else %}
                            {{box_row.1}}{{box_column.1}}
                            {% endif %}
                        </td>
                    {% endfor %}
                {% else %}
                <td class="box-position box-position-empty text-light" data-bs-toggle="tooltip" data-bs-placement="top"
                    title="{% if render_mod == 'n'  %}-{% else %}Available{% endif %}"
                    data-box_id="{{box.id}}"
                    data-box_row="{{box_row.1}}"
                    data-box_column="{{box_column.1}}"
                >{{box_row.1}}{{box_column.1}}</td>
                {% endif %}
                {% endwith %}

                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </div>
</div>